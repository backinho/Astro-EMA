---

---

<form id="productForm" class="form-class">
    <div>
        <div
            class="bg-(--bg-secondary) p-(--spacing-lg) rounded-lg border border-(--border-color)"
        >
            <h3
                class="text-lg font-semibold text-(--text-primary) mb-(--spacing-md) pb-(--spacing-sm) border-b border-(--border-color)"
            >
                Información del producto
            </h3>
            <div class="grid grid-cols-2 gap-(--spacing-lg)">
                <input type="hidden" id="productId" name="productId" />
                <div class="flex flex-col gap-(--spacing-sm)">
                    <label
                        for="productName"
                        class="text-sm font-medium text-(--text-primary)"
                        >Nombre</label
                    >
                    <input
                        class="p-(--spacing-sm) px-(--spacing-md) border border-(--border-color) rounded-lg bg-(--bg-secondary) text-(--text-primary) text-sm transition focus:outline-none focus:border-(--border-focus) focus:ring-2 focus:ring-blue-500/10"
                        type="text"
                        id="productName"
                        name="productName"
                        required
                    />
                </div>
                <div class="flex flex-col gap-(--spacing-sm)">
                    <label
                        for="productCode"
                        class="text-sm font-medium text-(--text-primary)"
                        >Código</label
                    >
                    <input
                        class="p-(--spacing-sm) px-(--spacing-md) border border-(--border-color) rounded-lg bg-(--bg-secondary) text-(--text-primary) text-sm transition focus:outline-none focus:border-(--border-focus) focus:ring-2 focus:ring-blue-500/10"
                        type="text"
                        id="productCode"
                        name="productCode"
                        required
                    />
                </div>
                <div class="flex flex-col gap-(--spacing-sm)">
                    <label
                        for="productCategory"
                        class="text-sm font-medium text-(--text-primary)"
                        >Categoría</label
                    >
                    <div class="flex gap-(--spacing-xs)">
                        <select
                            class="flex-1 p-(--spacing-sm) px-(--spacing-md) border border-(--border-color) rounded-lg bg-(--bg-secondary) text-(--text-primary) text-sm transition focus:outline-none focus:border-(--border-focus) focus:ring-2 focus:ring-blue-500/10"
                            id="productCategory"
                            name="productCategory"
                            required
                        >
                            <option value="">Seleccionar categoría</option>
                            <option value="1">Categoría 1</option>
                            <option value="2">Categoría 2</option>
                            <option value="3">Categoría 3</option>
                        </select>
                        <button class="btn btn-secondary btn-sm">
                            <svg
                                class="btn-icon"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                            >
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="flex flex-col gap-(--spacing-sm)">
                    <label
                        for="productState"
                        class="text-sm font-medium text-(--text-primary)"
                        >Estado</label
                    >
                    <select
                        class="p-(--spacing-sm) px-(--spacing-md) border border-(--border-color) rounded-lg bg-(--bg-secondary) text-(--text-primary) text-sm transition focus:outline-none focus:border-(--border-focus) focus:ring-2 focus:ring-blue-500/10"
                        id="productState"
                        name="productState"
                        required
                    >
                        <option value="">Seleccionar estado</option>
                        <option value="1">Activo</option>
                        <option value="2">Inactivo</option>
                    </select>
                </div>
                <div class="flex flex-col gap-(--spacing-sm) col-span-full">
                    <label
                        for="productDescription"
                        class="text-sm font-medium text-(--text-primary)"
                        >Descripción</label
                    >
                    <textarea
                        class="p-(--spacing-sm) px-(--spacing-md) border border-(--border-color) rounded-lg bg-(--bg-secondary) text-(--text-primary) text-sm transition focus:outline-none focus:border-(--border-focus) focus:ring-2 focus:ring-blue-500/10"
                        id="productDescription"
                        name="productDescription"
                        required></textarea>
                </div>
                <div class="flex flex-col gap-(--spacing-sm) col-span-full">
                    <label
                        for="productImage"
                        class="text-sm font-medium text-(--text-primary)"
                        >Imagen</label
                    >
                    <div class="flex flex-col gap-(--spacing-md)">
                        <div
                            class="grid grid-cols-[repeat(auto-fill,minmax(100px,1fr))] gap-(--spacing-md)"
                            id="productImagePreview"
                        >
                        </div>
                        <input
                            id="productImage"
                            name="productImage"
                            type="file"
                            class="hidden"
                            required
                            multiple
                        />
                        <label
                            for="productImage"
                            class="flex flex-col items-center justify-center h-40 w-full cursor-pointer border-2 border-dashed border-(--border-color) rounded-lg bg-(--bg-secondary) hover:bg-(--bg-tertiary) transition"
                        >
                            <div
                                class="w-12 h-12 bg-[linear-gradient(135deg,var(--primary-color),var(--primary-dark))] rounded-md flex items-center justify-center text-white font-bold text-[1.125rem]"
                            >
                                <img
                                    src="/upload.webp"
                                    class="w-6 h-6"
                                    alt="logo"
                                />
                            </div>

                            <span class="text-sm text-(--text-primary)">
                                Subir imagen
                            </span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>

<script>
    let productFiles = [] as File[];

    const imageInput = document.getElementById(
        "productImage",
    ) as HTMLInputElement;
    const previewContainer = document.getElementById(
        "productImagePreview",
    ) as HTMLDivElement;

    imageInput?.addEventListener("change", () => {
        previewContainer.innerHTML = "";
        const files = imageInput.files;

        if (files) {
            // Iterar sobre todos los archivos seleccionados
            for (let i = 0; i < files.length; i++) {
                const file = files[i];

                if (file.type.startsWith("image/")) {
                    productFiles.push(file);
                }

                renderProductImages();

                imageInput.value = "";
            }
        }
    });

    function renderProductImages() {
        previewContainer.innerHTML = "";

        productFiles.forEach((file, index) => {
            const reader = new FileReader();

            // Definir qué hacer una vez que el archivo se haya leído
            reader.onload = (e) => {
                // Crear un contenedor para la imagen (opcional, para el estilo)
                const imageWrapper = document.createElement("div");
                const removeButton = document.createElement("button");
                removeButton.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-3 h-3 stroke-[2]">
                                                        <line x1="18" y1="6" x2="6" y2="18"></line>
                                                        <line x1="6" y1="6" x2="18" y2="18"></line>
                                                    </svg>`;
                removeButton.className =
                    "absolute top-(--spacing-xs) right-(--spacing-xs) w-6 h-6 flex items-center justify-center bg-[rgba(239,68,68,0.9)] text-white rounded-full cursor-pointer transition-all duration---transition-fast) hover:bg-(--error-color) hover:scale-110";
                removeButton.addEventListener("click", () => {
                    imageWrapper.remove();
                    productFiles.splice(index, 1);
                    renderProductImages();
                });
                imageWrapper.className =
                    "relative aspect-square rounded-lg overflow-hidden border border-(--border-color)"; // Clase para estilo

                // Crear el elemento de la imagen
                const img = document.createElement("img") as HTMLImageElement;
                img.src = e.target?.result as string; // Establecer la URL de datos como la fuente
                img.alt = file.name;
                img.className = "w-full h-full object-cover"; // Clase para estilo

                // Añadir la imagen al contenedor
                imageWrapper.appendChild(img);
                imageWrapper.appendChild(removeButton);

                // Añadir el contenedor al área de previsualización
                previewContainer.appendChild(imageWrapper);
            };

            // Leer el archivo como una URL de datos (Data URL)
            reader.readAsDataURL(file);
        });
    }
</script>
